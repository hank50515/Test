<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html" 
      xmlns:ui="http://java.sun.com/jsf/facelets">
  
<ui:composition template="/templates/template.xhtml">

<ui:define name="title"><h:outputText value="#{msg['tab.header.title.fullTextSearch']}" /></ui:define>

<ui:define name="head">
  <script type="text/javascript" src="${contextPath}/js/jquery.highlight/jquery.highlight.js"></script>
  
  <script type="text/javascript" src="${contextPath}/js/adm/service/projectService.js?${currentVersion}"></script>
  
  <script type="text/javascript" src="${contextPath}/js/adm/controller/fullTextSearchController.js?${currentVersion}"></script>
  
  <link rel="stylesheet" type="text/css" href="${contextPath}/css/adm/full_text_search.css?${currentVersion}" />
</ui:define>

<ui:define name="body">
	<div class="layout-main-wrap layout-inquire" ng-controller="fullTextSearchControl">
		<div class="main-head">
			<div class="sg-cell-group">
				<div class="sg-cell sg-cell--fit">
					<span>#{msg['label.searchResults']}</span>
				</div>
			</div>
		</div>
		<div class="main-work -fulltext-search" ng-class="{'is-has-pager': entities.length != 0}">
			<div class="sg-cell-group qu-full-height sg-cell--fixed">
				<div class="sg-cell -va-top qu-fulltext-entities" ng-show="entities.length == 0">
					<div class="is-midcenter-table">
						<div class="is-midcenter-cell">
							<figure class="qu-hintpic-empty">
								<img src="${contextPath}/images/v3/pic_empty.svg" alt="empty" />
								<p class="qu-fullTextSearch-NoResult">#{msg['label.noSearchResult']}</p>
							</figure>
						</div>
					</div>
				</div>
				<div class="sg-cell -va-top qu-fulltext-entities" ng-show="entities.length != 0">
					<div class="sg-scroll qu-full-height">
						<div class="qu-fulltext-entity" ng-repeat="entity in entities">
							<div class="qu-fulltext-entity-basicInfo">
								<div class="sg-cell-group sg-cell--fixed">
									<div class="sg-cell sg-text--right qu-fulltext-entity-field-name">
										<div class="sg-ellipsis">
											<span>#{msg['table.header.title.projectName']}</span>
										</div>
									</div>
									<div class="sg-cell qu-fulltext-entity-field-content">
										<div class="sg-cell-group">
											<div class="sg-cell">
												<div class="sg-ellipsis">
													<span class="highlightData">{{entity.projectCode}}</span>
												</div>
											</div>
											<div class="sg-cell sg-cell--fit sg-text--right">
												<span class="qu-legend-span qu-lengend-ci-type" ng-style="{'background-color' : entity.entityDefinition.icon}">{{entity.entityDefinition.name}}</span>
												<button ng-show="entity.entityDefinition.haveSource" title="#{msg['page.header.viewSourceCode']}" class="sg-btn sg-btn-default sg-btn-icon" ng-click="redirectToViewSourceCodePage(entity)">
												    <i class="icon-qu-code-source"></i>
												</button>
												<button class="sg-btn sg-btn-default sg-btn-icon ciMaintainIcon" title="#{msg['button.viewCIMaintain']}" ng-click="redirectToCiMaintainPage(entity)">
													<i class="icon-pencil-square-o"></i>
												</button>
												<button class="sg-btn sg-btn-default sg-btn-icon relationSettingIcon" title="#{msg['button.viewCIRelationship']}" ng-click="redirectToCiRelationSettingPage(entity)">
												    <i class="icon-qu-CI-relationship"></i>
												</button>
												<button class="sg-btn sg-btn-default sg-btn-icon treeDependencyIcon" title="#{msg['tab.header.title.dependencyInquiry.viewTreeDependency']}" ng-click="redirectToTreeDependencyPage(entity)">
												    <i class="icon-qu-CI-search"></i>
												</button>
											</div>
										</div>
									</div>
								</div>
								<div class="sg-cell-group sg-cell--fixed">
									<div class="sg-cell sg-text--right qu-fulltext-entity-field-name">
										<div class="sg-ellipsis">
											<span>#{msg['common.code']}</span>
										</div>
									</div>
									<div class="sg-cell qu-fulltext-entity-field-content" title="{{entity.displayCode}}">
										<div class="sg-ellipsis">
											<span class="highlightData">{{entity.displayCode}}</span>
										</div>
									</div>
								</div>
								<div class="sg-cell-group sg-cell--fixed">
									<div class="sg-cell sg-text--right qu-fulltext-entity-field-name">
										<div class="sg-ellipsis">
											<span >#{msg['common.name']}</span>
										</div>
									</div>
									<div class="sg-cell qu-fulltext-entity-field-content" title="{{entity.displayName}}">
										<div class="sg-ellipsis">
											<span class="highlightData">{{entity.displayName}}</span>
										</div>
									</div>
								</div>
							</div>
							<div id="{{entity.id}}_separatorLine" class="qu-moreInfoWrap">
								<hr/>
								<button class="sg-btn sg-btn-default sg-btn-primary sg-btn-more" ng-class="{'--down': !entity.showMore, '--up': entity.showMore}" ng-click="toggleMoreInfo(entity)">
							    	<i ng-class="{'icon-chevron-down': !entity.showMore, 'icon-chevron-up': entity.showMore}"></i>
							 	</button>
							</div>
							<div class="qu-fulltext-entity-moreInfo sg-scroll" ng-if="entity.showMore">
								<div class="sg-cell-group sg-cell--fixed" ng-repeat="attributeDefinition in entity.attributeDefinitions">
									<div class="sg-cell sg-text--right qu-fulltext-entity-field-name">
										<div class="sg-ellipsis" title="{{attributeDefinition.displayName}}">
											<span>{{attributeDefinition.displayName}}</span>
										</div>
									</div>
									<div class="sg-cell qu-fulltext-entity-field-content" title="{{entity.modelAttributeMap[attributeDefinition.name].modelAttributeValue}}">
										<div class="sg-ellipsis">
											<span class="highlightData">{{entity.modelAttributeMap[attributeDefinition.name].modelAttributeValue}}</span>
										</div>
									</div>
								</div>
								<div class="sg-cell-group sg-cell--fixed">
									<div class="sg-cell sg-text--right qu-fulltext-entity-field-name">
										<div class="sg-ellipsis" title="#{msg['label.sourceCodeContent']}">
											<span>#{msg['label.sourceCodeContent']}</span>
										</div>
									</div>
									<div class="sg-cell qu-fulltext-entity-field-content">
										<div class="sg-ellipsis">
											<span class="highlightData">{{entity.fileContent}}</span>
										</div>
									</div>
								</div>
								<div class="sg-scroll--x qu-fulltext-entity-otherInfo">
									<span>#{msg['common.version']}：</span>
									<span class="highlightData">{{entity.revision}}</span>
									<span>#{msg['grid.creationDate']}：</span>
									<span class="highlightData">{{entity.creationDate | date:'yyyy-MM-dd' }}</span>
									<span>#{msg['grid.creationUser']}：</span>
									<span class="highlightData">{{entity.creator}}</span>
									<span>#{msg['grid.modificationDate']}：</span>
									<span class="highlightData">{{entity.modificationDate | date:'yyyy-MM-dd' }}</span>
									<span>#{msg['grid.modificationUser']}：</span>
									<span class="highlightData">{{entity.modifiedUser}}</span>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div id="definitionBar" class="sg-cell sg-cell--fit -va-top qu-fulltext-definitions">
					<div class="sg-scroll qu-full-height">
						<ul>
							<li ng-repeat="(entityDefinitionId, entityDefinition) in entityDefinitionMap" ng-click="selectEntityDefnition(entityDefinitionId)" ng-class="{'--selected' : selectedEntityDefinitionId == entityDefinitionId}">
								<div class="sg-cell-group" title="{{entityDefinition.name}}">
									<div class="sg-cell sg-cell--fit">
										<span class="qu-narrow-legend-span" style="background-color: {{entityDefinition.icon}}">{{entityDefinition.narrowName}}</span>
									</div>
						            <div class="sg-cell sg-text--center">
						            	<div class="sg-ellipsis">
											{{entityDefinition.name}}
						            	</div>
									</div>
									<div class="sg-cell sg-cell--fit">
										<span class="sg-badge">{{entityDefinitionCountMap[entityDefinitionId] || 0}}</span>
									</div>
					            </div>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<div class="main-pagination" ng-if="entities.length != 0">
			<div class="sg-cell sg-cell--fit">
				<nav class="sg-pagination sg-pagination--bordered sg-pagination--gap sg-cell sg-cell--fit" style="width: auto;">
					<ul>
						<li class="sg-page-item" ng-click="selectPage(1)"><a class="sg-page-item__link" href="#">First</a></li>
						<li class="sg-page-item"><a class="sg-page-item__link" href="#" ng-click="previousPage()">
							<i class="icon-chevron-left"></i></a></li>
						<li class="sg-page-item">
							<div id="pager" />
							<input kendo-drop-down-list="pages" k-options="pagesOptions" k-ng-delay="pagesOptions" k-rebind="pagesOptions" k-ng-model="currentPage" />
						</li>
						<li class="sg-page-item"><a class="sg-page-item__link" href="#" ng-click="nextPage()">
							<i class="icon-chevron-right"></i></a></li>
						<li class="sg-page-item" ng-click="selectPage(maxPage)"><a class="sg-page-item__link" href="#">Last</a></li>
					</ul>
				</nav>
			</div>
    		<div class="sg-cell sg-cell--fit sg-text--right">
				<span> {{currentPage == 1 ? 1 : (currentPage - 1) * PAGESIZE +1 }}</span>
				<span> - </span>
				<span> {{(currentPage) * PAGESIZE &gt; total? total : (currentPage) * PAGESIZE}} </span>
				<span> #{msg['common.items.of']} </span>
				<span> {{total}} </span>
				<span> #{msg['common.items.total']}</span>
    		</div>
		</div>
	</div>
</ui:define>
</ui:composition>
</html>